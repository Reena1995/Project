(function ($) {
    'use strict';

    /**
     * @property colors
     * @description SET colors for charts, includes system colors and pastel colors for charts
     * @returns {array} - array of colors/colours
     */
    var body = $("body"), windowWidth = window.innerWidth;
    window.colors = [
        "#687ae8",
        "#12bfbb",
        "#ffb058",
        "#2991cf",
        "#87b8d4",
        "#109693",
        "#f29494",
        "#527cf9",
        "#7140d1",
        "#e79e4e",
        "#52b4ee",
        "#6ed7e0",
        "#8fa6b4",
        "#ffcfcf",
        "#28304e",
        "#95aac9",
        "#f2545b",
        "#f7bc06",
        "#00cc99",
        "#19b5fe",
        "#E3EBF6"
    ];

    /**
     * @description sidebar operations like sliding sidebar,toggle and responsive options
     * @param {(Element|jQuery)} [context] - A DOM Element, Document, or jQuery to use as context.
     * @requires jQuery
     */

    // sidebar mouse events
    $(document).on("mouseenter", "body:not(.sidebar-pinned) .admin-sidebar", function (e) {
        if (windowWidth >= 1200) {
            $(this).addClass("sidebar-show");

        }
    });
    $(document).on("mouseleave", "body:not(.sidebar-pinned) .admin-sidebar", function (e) {
        if (windowWidth >= 1200) {
            $(this).removeClass("sidebar-show");
        }
    });

    //sidebar pin - toggle sidebar pin
    $(document).on("click", ".admin-pin-sidebar", function (e) {
        e.preventDefault();
        body.toggleClass("sidebar-pinned");
        $(this).toggleClass("pinned");
        // trigger resize event for charts to redraw if required
        window.dispatchEvent(new Event('resize'));
    });

    // append backdrop for mobile
    body.append('<div class="sidebar-backdrop "></div>');

    // close event on mobile by clicking close button or backdrop
    $(document).on("click", " .admin-close-sidebar ,.sidebar-backdrop", function (e) {
        e.preventDefault();
        body.removeClass("sidebar-open");

    });

    /**
     * @description Sidebar Multilevel Menu
     * @param {(Element|jQuery)} [context] - A DOM Element, Document, or jQuery to use as context.
     * @requires jQuery
     */
    $(document).on("click", ".open-dropdown", function (e) {
        e.preventDefault();
        if (!$(this).next().is(":visible")) {
            //opens the adjacent list to the target
            $(this).next().slideDown();
            $(this).parent().addClass("opened");
        }
        else {
            //closes the adjacent list to the target
            $(this).next().slideUp();
            $(this).parent().removeClass("opened");
        }
    });

    /**
     * @description Override Default Behaviour for scroll
     * @param {(Element|jQuery)} [context] - A DOM Element, Document, or jQuery to use as context.
     * @requires jquery.bootstrap
     */
    $('.modal').on('show.bs.modal', function (e) {
        if ($(e.currentTarget).attr("data-popup")) {
            body.addClass("body-scrollable");
        }
    });
    $('.modal').on('hidden.bs.modal', function (e) {
        body.removeClass("body-scrollable");
    });

    /**
     * @description Initialize custom scrollbar
     * @param {(Element|jQuery)} [context] - A DOM Element, Document, or jQuery to use as context.
     * @requires jquery.scrollbar plugin
     */
    $(".js-scrollbar").scrollbar();



    /**
     * @description toggles the target class with class given in toggleclass attr
     * * @param {(Element|jQuery)} [context] - A DOM Element, Document, or jQuery to use as context.
     * @requires jQuery
     */
        $(document).on("click", "[data-toggleclass]", function (e) {
            e.preventDefault();
            $($(this).attr("data-target")).toggleClass($(this).attr("data-toggleClass"));
        });

        /////////////////////////////////////////////////
        $(document).on('click', '.delete_row-tab', function () {
            console.log('delete');
            var deletedbtnone = $(this).closest('.hourly').remove();
            var deletedbtwo = $(this).closest('.flat').remove();
            var deletedbthree = $(this).closest('.contingency').remove();
            console.log($(this).closest('.hourly'));
            console.log(deletedbtwo);
            console.log(deletedbthree);
            var data = $('#myTab li .active');
            console.log(data.attr('id'));

            if (data.attr('id') == 'hourly-tab-z') {

                var subtotalhour = 0;
                $(".hourtotal").each(function (index, value) {
                    subtotalhour += Number($(this).val());

                });
                console.log(subtotalhour, 'total sum');
            }
            else if (data.attr('id') == 'flat-rate-tab-z') {

                var subtotalflat = 0;
                $(".flattotal").each(function (index, value) {
                    subtotalflat += Number($(this).val());
    
                });
                console.log(subtotalflat, 'total sum');
            }
            else if (data.attr('id') == 'contingency-fee-tab-z') {

                
            }

            
        

        });
        /////////////////////hour counting start////////////////
        var hourpricevalue = 0;
        var hourqtyvalue = 0;
        var total_hours = 0;
        var total_working_total = 0;

        $(document).on('blur', '.hourprice', function () {

            console.log(".hourprice");
            hourpricevalue = $(this).val();
            console.log(hourpricevalue);
            $('a').closest('td').siblings().find('input')
            hourqtyvalue = $(this).closest('td').siblings().find('.hourqty').val();
            // console.log(hourqtyvalue);
            // console.log($(this).closest('td').siblings().find('.hourtotal').val())

            total_hours = hourpricevalue * hourqtyvalue;
            console.log(total_hours);
            total_working_total = ($(this).closest('td').siblings().find('.hourtotal').val(total_hours));

            console.log($(this).closest('td').siblings().find('.hourtotal').val(total_hours));



            subtotalhour = total_working_total;
            console.log(subtotalhour, 'subtotalhour');


            // var sum = 0;

            // $(".hourtotal").each(function (index, value) {
            //     sum += Number($(this).val());

            // });
            // console.log(sum,'total sum');

            var subtotalhour = 0;
            $(".hourtotal").each(function (index, value) {
                subtotalhour += Number($(this).val());

            });
            console.log(subtotalhour, 'total sum');



        });
        /////////////////flat counting start ////////////////////////////
        var flatpricevalue = 0;
        var total_flat = 0;
        var total_flat_total = 0;
        // var subtotal_flat=0;
        $(document).on('change', '.flatprice', function () {

            console.log(".flatprice");
            flatpricevalue = $(this).val();
            console.log(flatpricevalue);



            total_flat = flatpricevalue;
            console.log(total_flat, 'total_flat');
            total_flat_total = ($(this).closest('td').siblings().find('.flattotal').val(total_flat));
            console.log($(this).closest('td').siblings().find('.flattotal').val(total_flat));


            var subtotalflat = 0;
            $(".flattotal").each(function (index, value) {
                subtotalflat += Number($(this).val());

            });
            console.log(subtotalflat, 'total sum');


        });
        $(document).ready(function () {
            $("#add_row").click(function () {

                console.log('first click');
                // var data= $(this).parents()[2];
                var data = $('#myTab li .active');
                console.log(data.attr('id'));


                if (data.attr('id') == 'hourly-tab-z') {
                    console.log('hhhhh');
                    var houcontent = `<tr class="hourly">
                    <td><input type="text" name='product[]'
                        placeholder='Description'
                        class="form-control" /></td>
                    <td><input type="number" name='qty[]' placeholder='Hours' class="form-control qty hourqty" step="0" min="0"/>
                    <td><input type="number" name='price[]' placeholder='Rate per Hours' class="form-control price hourprice" step="0.00" min="0"/></td>
                    <td><input type="number" name='total[]' placeholder='0.00' class="form-control total hourtotal" readonly/></td>
                    <td><i style="font-size: 25px; "
                        class="icon-placeholder mdi mdi-minus-box-outline delete_row-tab"></i>
                    </td>
                </tr>`;
                    console.log(houcontent);
                    var hourappend = $('#hourly-rate-content').append(houcontent);
                    // console.log(hourappend);

                }
                else if (data.attr('id') == 'flat-rate-tab-z') {
                    console.log('ffff');
                    var flatcontent = `                                                                            <tr class="flat">
                    <td><input type="text" name='product[]'
                            placeholder='Description'
                            class="form-control" /></td>
                    <td><input type="number" name='price[]'
                            placeholder='Flat Rate'
                            class="form-control price flatprice"
                            step="0.00" min="0" /></td>
                    <td><input type="number" name='total[]'
                            placeholder='0.00'
                            class="form-control total flattotal"
                            readonly /></td>
                    <td><i style="font-size: 25px;"
                            class="icon-placeholder mdi mdi-minus-box-outline delete_row-tab"></i>
                    </td>
                </tr>`;
                    console.log(flatcontent);
                    var hourappend = $('#flat-rate-content').append(flatcontent);
                }
                else if (data.attr('id') == 'contingency-fee-tab-z') {
                    console.log('vvvvv');
                    var contigencyfees = `                                                                            <tr class="contingency">
                    <td><input type="text" name='product[]'
                            placeholder='Description'
                            class="form-control" /></td>
                    <td><input type="number" name='qty[]'
                            placeholder='Win Amount'
                            class="form-control qty contqty"
                            step="0" min="0" />
                        </th>
                    <td><input type="number" name='price[]'
                            placeholder='Rate'
                            class="form-control price contprice"
                            step="0.00" min="0" /></td>
                    <td><input type="number" name='total[]'
                            placeholder='0.00'
                            class="form-control total conttotal"
                            readonly /></td>
                    <td><i style="font-size: 25px; "
                            class="icon-placeholder mdi mdi-minus-box-outline delete_row-tab"></i>
                    </td>
                </tr>`;
                    console.log(contigencyfees);
                    var contigencyappend = $('#contingency-fee-content').append(contigencyfees);
                }


            });
            ////////////////////////add row end/////////////////////////////////////////
            /////////////////delete button on tab start code/////////////////
        

            /////////////////delete button on tab end code/////////////////
        

            // var houqtyvalue = 0;

            // $(document).on('change','.hourqty',function(){

            //     console.log(".hourqty");

            //     houqtyvalue = $(this).val();
            //     // var hourqunity = $("#start").find('myClass').val(); 
            //     console.log(houqtyvalue);
            // });
            // $(document).on('change','.hourprice',function(){

            //     console.log(".hourprice");

            //     var houpricevalue = $(this).val();
            //     console.log(houqtyvalue,'houqtyvalue');
            //     console.log(houpricevalue * houqtyvalue);
            // })
            // $(".hourtotal").click(function () {
            //     console.log(".hourtotal");

            //     var hourwisepayment =$(houqtyvalue).val() * $(houpricevalue).val();
            //     console.log(hourwisepayment);
            //     // var hourqunity = $("#start").find('myClass').val(); 
            // })
            /////////////////////hour counting start////////////////

        
        

        });
        /////////////////flat counting end ////////////////////////////
        /////////////////continus start counting///////////////////////

        // var contpricevalue = 0;
        // var contqtyvalue = 0;
        // var total_cont = 0;
        // var total_cont_total = 0;

        // $(document).on('blur', '.contprice', function () {

        //     console.log(".contprice");
        //     contpricevalue = $(this).val();
        //     console.log(contpricevalue);
        //     contqtyvalue = $(this).closest('td').siblings().find('.contqty').val();
        //     console.log(contqtyvalue);

        //     total_cont = contpricevalue * contqtyvalue / 100;
        //     console.log(total_cont);
        //     total_cont_total = ($(this).closest('td').siblings().find('.conttotal').val(total_cont));
        //     console.log($(this).closest('td').siblings().find('.conttotal').val(total_cont));

        //     var subtotalcont = 0;
        //     $(".conttotal").each(function (index, value) {
        //         subtotalcont += Number($(this).val());

        //     });
        //     console.log(subtotalcont, 'total sum');



        // });

        /////////////////continus end counting///////////////////////
        ///////////subtotal start /////////////////////

        ///////////subtotal end /////////////////////

})(window.jQuery);
